# Override imagePullPolicy for local development without registry
# This patches all deployments to use Never to ensure they use locally loaded images
# Kind loads images directly into the cluster, so we don't need to pull
# Only locally-built images are patched; external images (redis, postgres) keep their defaults
apiVersion: apps/v1
kind: Deployment
metadata:
  name: api-service
spec:
  template:
    spec:
      containers:
      - name: api-service
        imagePullPolicy: Never
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: storage-service
spec:
  template:
    spec:
      containers:
      - name: storage-service
        imagePullPolicy: Never
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: storage-worker
spec:
  template:
    spec:
      containers:
      - name: storage-worker
        imagePullPolicy: Never
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: celery-worker
spec:
  template:
    spec:
      containers:
      - name: celery-worker
        imagePullPolicy: Never
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: dispatcher
spec:
  template:
    spec:
      containers:
      - name: dispatcher
        imagePullPolicy: Never
---
apiVersion: batch/v1
kind: Job
metadata:
  name: db-migrate
spec:
  template:
    spec:
      containers:
      - name: migrate
        imagePullPolicy: Never
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend-deployment
spec:
  template:
    spec:
      containers:
      - name: frontend
        imagePullPolicy: Never